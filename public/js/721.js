"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[721],{60721:(t,e,n)=>{n.r(e),n.d(e,{default:()=>l});var r=n(66186),a=n(45168),s=n(9669),o=n.n(s);const i={name:"ContentClientDebts",components:{SelectInput:r.Z,TextInput:a.Z},props:{},data:function(){return{debt_branch_id:0,debt_amount:0,market_branches:[],markets:[],branches:[]}},created:function(){this.getMarkets()},watch:{},computed:{},methods:{getMarkets:function(){var t=this;o().get("get-markets").then((function(e){t.markets=e.data.markets,t.branches=e.data.branches}))},onCompanyClicked:function(t,e){this.market_branches=t.branches,this.$modal.show("company_branches")},changeDebtStart:function(t){o().post("dolg-start",{id:t.id,amount:t.debt_start})},soldTotal:function(t){for(var e=0,n=0;n<t.branches.length;n++)e+=t.branches[n].sold;return e},paidTotal:function(t){for(var e=0,n=0;n<t.branches.length;n++)e+=t.branches[n].paid;return e},getRealizators:function(t){var e=new Set;return t.branches.map((function(t){t.realizators.map((function(t){e.add(t.first_name)}))})),e},payDebt:function(){var t=this;o().post("pay-owe",{branch_id:this.debt_branch_id,amount:this.debt_amount}).then((function(e){t.$modal.hide("add-money"),alert("долг оплачен!"),location.reload()}))}}};const l=(0,n(51900).Z)(i,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"w-full bg-white rounded-2xl  h-auto p-6 overflow-y-auto"},[n("div",{staticClass:"flex justify-start gap-5 items-center"},[n("h3",{staticClass:"font-bold"},[t._v("Долги")]),t._v(" "),n("button",{staticClass:"bg-blue-500 text-white font-bold py-2 px-4 rounded h-8",on:{click:function(e){return t.$modal.show("add-money")}}},[t._v("\r\n            + Оплата\r\n        ")])]),t._v(" "),n("table",{staticClass:"w-full whitespace-nowrap mt-5 mb-10"},[t._m(0),t._v(" "),t._l(t.markets,(function(e,r){return n("tr",{key:e.id,staticClass:"text-left border-b border-gray-200"},[n("td",{staticClass:"cursor-pointer",on:{click:function(n){return t.onCompanyClicked(e,r)}}},[t._v("\r\n                "+t._s(e.name)+"\r\n            ")]),t._v(" "),n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.debt_start,expression:"market.debt_start"}],attrs:{type:"number"},domProps:{value:e.debt_start},on:{change:function(n){return t.changeDebtStart(e)},input:function(n){n.target.composing||t.$set(e,"debt_start",n.target.value)}}})]),t._v(" "),n("td",[t._v(t._s(t.soldTotal(e)))]),t._v(" "),n("td",[t._v(t._s(t.paidTotal(e)))]),t._v(" "),n("td",[t._v(t._s((e.debt_start+t.soldTotal(e)-t.paidTotal(e)).toFixed(2)))]),t._v(" "),n("td",t._l(t.getRealizators(e),(function(e,r){return n("div",{key:r},[t._v(t._s(e))])})),0)])}))],2),t._v(" "),n("modal",{attrs:{name:"add-money"}},[n("div",{staticClass:"p-5"},[n("select-input",{staticClass:"pr-6 pb-8 w-full lg:w-1/1",attrs:{label:"Магазин"},model:{value:t.debt_branch_id,callback:function(e){t.debt_branch_id=e},expression:"debt_branch_id"}},t._l(t.branches,(function(e){return n("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.name))])})),0),t._v(" "),n("text-input",{staticClass:"pr-6 pb-8 w-full lg:w-1/1",attrs:{label:"Сумма"},model:{value:t.debt_amount,callback:function(e){t.debt_amount=e},expression:"debt_amount"}}),t._v(" "),n("button",{staticClass:"bg-blue-500 text-white font-bold py-2 px-4 rounded",on:{click:function(e){return t.payDebt()}}},[t._v("\r\n                Оплатить долг\r\n            ")])],1)]),t._v(" "),n("modal",{attrs:{name:"company_branches"}},[n("div",{staticClass:"px-6 py-6"},[t._v("\r\n            Филиалы магазина\r\n            "),n("table",{staticClass:"w-full whitespace-nowrap mt-5"},[n("tr",{staticClass:"text-left  border-b border-gray-200"},[n("th",[t._v("Название")]),t._v(" "),n("th",[t._v("Продано")]),t._v(" "),n("th",[t._v("Оплачено")]),t._v(" "),n("th",[t._v("Остальной долг")])]),t._v(" "),t._l(t.market_branches,(function(e){return n("tr",{key:e.id,staticClass:"text-left  border-b border-gray-200"},[n("td",[t._v(t._s(e.name))]),t._v(" "),n("td",[t._v(t._s(e.sold))]),t._v(" "),n("td",[t._v(t._s(e.paid))]),t._v(" "),n("td",[t._v(t._s((e.sold-e.paid).toFixed(2)))])])}))],2)])])],1)}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("tr",{staticClass:"text-left  border-b border-gray-200"},[n("th",[t._v("Магазин")]),t._v(" "),n("th",[t._v("Начальный долг")]),t._v(" "),n("th",[t._v("Продано")]),t._v(" "),n("th",[t._v("Оплачено")]),t._v(" "),n("th",[t._v("Остальной долг")]),t._v(" "),n("th",[t._v("Реализатор")])])}],!1,null,null,null).exports},66186:(t,e,n)=>{n.d(e,{Z:()=>a});const r={inheritAttrs:!1,props:{id:{type:String,default:function(){return"select-input-".concat(this._uid)}},value:[String,Number,Boolean],label:String,error:String},data:function(){return{selected:this.value}},watch:{selected:function(t){this.$emit("input",t)}},methods:{focus:function(){this.$refs.input.focus()},select:function(){this.$refs.input.select()}}};const a=(0,n(51900).Z)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.label?n("label",{staticClass:"form-label",attrs:{for:t.id}},[t._v(t._s(t.label)+":")]):t._e(),t._v(" "),n("select",t._b({directives:[{name:"model",rawName:"v-model",value:t.selected,expression:"selected"}],ref:"input",staticClass:"form-select",class:{error:t.error},attrs:{id:t.id},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.selected=e.target.multiple?n:n[0]}}},"select",t.$attrs,!1),[t._t("default")],2),t._v(" "),t.error?n("div",{staticClass:"form-error"},[t._v(t._s(t.error))]):t._e()])}),[],!1,null,null,null).exports},45168:(t,e,n)=>{n.d(e,{Z:()=>o});function r(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}const s={inheritAttrs:!1,props:{id:{type:String,default:function(){return"text-input-".concat(this._uid)}},type:{type:String,default:"text"},col:{type:Boolean,default:!0},value:String,label:String,error:String},methods:{focus:function(){this.$refs.input.focus()},select:function(){this.$refs.input.select()},setSelectionRange:function(t,e){this.$refs.input.setSelectionRange(t,e)},onEnter:function(t){console.log("on enter...",t);var e=event.target.form,n=r(e).indexOf(event.target)+1;e.elements[n].select(),e.elements[n].focus(),event.preventDefault()}}};const o=(0,n(51900).Z)(s,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"flex",class:{"flex-col":!t.col}},[n("div",{class:{"w-3/12":t.col}},[t.label?n("label",{staticClass:"form-label font-medium",attrs:{for:t.id}},[t._v(t._s(t.label)+":")]):t._e()]),t._v(" "),n("div",{class:{"w-9/12":t.col}},[n("input",t._b({ref:"input",staticClass:"w-full block  pb-1 border-b-2 border-gray-200",class:{error:t.error},attrs:{id:t.id,onclick:"select()",type:t.type},domProps:{value:t.value},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onEnter.apply(null,arguments)},input:function(e){return t.$emit("input",e.target.value)}}},"input",t.$attrs,!1)),t._v(" "),n("div",{staticClass:"w-full mt-1"},[t.error?n("div",{staticClass:"form-error"},[t._v(t._s(t.error))]):t._e()])])])}),[],!1,null,"6ecb489a",null).exports},51900:(t,e,n)=>{function r(t,e,n,r,a,s,o,i){var l,c="function"==typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=n,c._compiled=!0),r&&(c.functional=!0),s&&(c._scopeId="data-v-"+s),o?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),a&&a.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(o)},c._ssrRegister=l):a&&(l=i?function(){a.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:a),l)if(c.functional){c._injectStyles=l;var u=c.render;c.render=function(t,e){return l.call(e),u(t,e)}}else{var d=c.beforeCreate;c.beforeCreate=d?[].concat(d,l):[l]}return{exports:t,options:c}}n.d(e,{Z:()=>r})}}]);
//# sourceMappingURL=721.js.map?id=3dd4b6f2735a5ce3